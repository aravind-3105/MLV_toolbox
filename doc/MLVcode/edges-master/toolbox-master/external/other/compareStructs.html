<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of compareStructs</title>
  <meta name="keywords" content="compareStructs">
  <meta name="description" content="check two structures for differances - i.e. see if strucutre s1 == structure s2">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../../index.html">Home</a> &gt;  <a href="../../../../index.html">MLVcode</a> &gt; <a href="../../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="../index.html">external</a> &gt; <a href="index.html">other</a> &gt; compareStructs.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../../index.html"><img alt="<" border="0" src="../../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\external\other&nbsp;<img alt=">" border="0" src="../../../../../right.png"></a></td></tr></table>-->

<h1>compareStructs
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="box"><strong>check two structures for differances - i.e. see if strucutre s1 == structure s2</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="box"><strong>function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> check two structures for differances - i.e. see if strucutre s1 == structure s2
 function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)

 inputs  6 - 5 optional
 s1      structure one                              class structure
 s2      structure two                              class structure - optional
 n1      first structure name (variable name)       class char - optional
 n2      second structure name (variable name)      class char - optional
 p       pause flag (0 / 1)                         class integer - optional
 tol     tol default tolerance (real numbers)       class integer - optional

 outputs 3 - 3 optional
 fs1     non-matching feilds for structure one      class cell - optional
 fs2     non-matching feilds for structure two      class cell - optional
 er      error flag (value)                         class 

 example:    [r1 r2] = compareStructs(data1,data2,'data1','data2',1)
 michael arant - april 5 2003

 hint:
 passing just one structure causes the program to copy the structure
 and compare the two.  This is an easy way to list the structure</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
<li><a href="compareStructs.html" class="code" title="function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)">compareStructs</a>	check two structures for differances - i.e. see if strucutre s1 == structure s2</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
<li><a href="compareStructs.html" class="code" title="function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)">compareStructs</a>	check two structures for differances - i.e. see if strucutre s1 == structure s2</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)</a>
0002 <span class="comment">% check two structures for differances - i.e. see if strucutre s1 == structure s2</span>
0003 <span class="comment">% function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% inputs  6 - 5 optional</span>
0006 <span class="comment">% s1      structure one                              class structure</span>
0007 <span class="comment">% s2      structure two                              class structure - optional</span>
0008 <span class="comment">% n1      first structure name (variable name)       class char - optional</span>
0009 <span class="comment">% n2      second structure name (variable name)      class char - optional</span>
0010 <span class="comment">% p       pause flag (0 / 1)                         class integer - optional</span>
0011 <span class="comment">% tol     tol default tolerance (real numbers)       class integer - optional</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% outputs 3 - 3 optional</span>
0014 <span class="comment">% fs1     non-matching feilds for structure one      class cell - optional</span>
0015 <span class="comment">% fs2     non-matching feilds for structure two      class cell - optional</span>
0016 <span class="comment">% er      error flag (value)                         class</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% example:    [r1 r2] = compareStructs(data1,data2,'data1','data2',1)</span>
0019 <span class="comment">% michael arant - april 5 2003</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% hint:</span>
0022 <span class="comment">% passing just one structure causes the program to copy the structure</span>
0023 <span class="comment">% and compare the two.  This is an easy way to list the structure</span>
0024 
0025 <span class="keyword">if</span> nargin &lt; 1; help <a href="compareStructs.html" class="code" title="function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)">compareStructs</a>; error(<span class="string">'I / O error'</span>); <span class="keyword">end</span>
0026 <span class="keyword">if</span> nargin &lt; 2; s2 = s1; <span class="keyword">end</span>
0027 <span class="keyword">if</span> nargin &lt; 3; n1 = <span class="string">'s1'</span>; <span class="keyword">end</span>
0028 <span class="keyword">if</span> nargin &lt; 4; n2 = <span class="string">'s2'</span>; <span class="keyword">end</span>
0029 <span class="keyword">if</span> nargin &lt; 5; p = 0; <span class="keyword">elseif</span> p ~= 1 &amp;&amp; p ~= 0; p = 0; <span class="keyword">end</span>
0030 <span class="keyword">if</span> nargin &lt; 6; tol = 1e-6; <span class="keyword">end</span>
0031 
0032 <span class="comment">% define fs</span>
0033 fs1 = {}; fs2 = {}; er = {};
0034 
0035 <span class="comment">% are the variables structures</span>
0036 <span class="keyword">if</span> isstruct(s1) &amp;&amp; isstruct(s2)
0037 <span class="comment">%    both structures - get the field names</span>
0038     fn1 = fieldnames(s1);
0039     fn2 = fieldnames(s2);
0040 <span class="comment">%    loop through structure 1 and match to structure 2</span>
0041     pnt1 = zeros(1,length(fn1));
0042     <span class="keyword">for</span> ii = 1:length(fn1)
0043         <span class="keyword">for</span> jj = 1:length(fn2)
0044             <span class="keyword">if</span> strcmp(fn1(ii),fn2(jj)); pnt1(ii) = jj; <span class="keyword">end</span>
0045         <span class="keyword">end</span>
0046     <span class="keyword">end</span>
0047     pnt2 = zeros(1,length(fn2));
0048     <span class="keyword">for</span> ii = 1:length(fn2)
0049         <span class="keyword">for</span> jj = 1:length(fn1)
0050             <span class="keyword">if</span> strcmp(fn2(ii),fn1(jj)); pnt2(ii) = jj; <span class="keyword">end</span>
0051         <span class="keyword">end</span>
0052     <span class="keyword">end</span>
0053 <span class="comment">%    get un-matched fields</span>
0054     <span class="keyword">for</span> ii = find(~pnt1)
0055         fs1 = [fs1; {[char(n1) <span class="string">'.'</span> char(fn1(ii))]}];
0056         fs2 = [fs2; {<span class="string">''</span>}]; er = [er; {<span class="string">'Un-matched'</span>}];
0057     <span class="keyword">end</span>
0058     <span class="keyword">for</span> ii = find(~pnt2)
0059         fs2 = [fs2; {[char(n2) <span class="string">'.'</span> char(fn2(ii))]}];
0060         fs1 = [fs1; {<span class="string">''</span>}]; er = [er; {<span class="string">'Un-matched'</span>}];
0061     <span class="keyword">end</span>
0062 <span class="comment">% %    look for non-matched fields fs1 to fs2</span>
0063 <span class="comment">%     fs1a = fn1(~pnt1);</span>
0064 <span class="comment">%     fs2a = setxor(pnt1,1:length(fn2));</span>
0065 <span class="comment">%     if ~isempty(fs2a); fs2a = fs2a(fs2a ~= 0);</span>
0066 <span class="comment">%         if ~isempty(fs2a)</span>
0067 <span class="comment">%             for kk = 1:length(fs2a)</span>
0068 <span class="comment">%                 fs2 = [fs2; {[char(n2) '.' char(fn2(fs2a(kk)))]}];</span>
0069 <span class="comment">%                 er = {'Un-matched'}; fs1 = [fs1; {''}];</span>
0070 <span class="comment">%             end</span>
0071 <span class="comment">%         end</span>
0072 <span class="comment">%     end</span>
0073 <span class="comment">%     if isempty(fs2); fs2 = cell(0,1); end</span>
0074 <span class="comment">%    now evaluate the matching fields  remove &quot;bad&quot; matched</span>
0075 <span class="comment">%    loop through structure fields</span>
0076     pnt1i = find(pnt1); pnt2i = find(pnt2);
0077     <span class="keyword">for</span> ii=1:numel(pnt1i)
0078 <span class="comment">%        added loop for indexed structured variables</span>
0079         <span class="keyword">for</span> jj = 1:size(s1,2)
0080 <span class="comment">%            clean display - add index if needed</span>
0081             <span class="keyword">if</span> size(s1,2) == 1
0082                 n1p = [n1 <span class="string">'.'</span> char(fn1(pnt1i(ii)))];
0083                 n2p = [n2 <span class="string">'.'</span> char(fn2(pnt2i(ii)))];
0084             <span class="keyword">else</span>
0085                 n1p = [n1 <span class="string">'('</span> num2str(jj) <span class="string">').'</span> char(fn1(ii))]; <span class="keyword">...</span>
0086                             n2p = [n2 <span class="string">'('</span> num2str(jj) <span class="string">').'</span> char(fn2(pnt2(ii)))];
0087             <span class="keyword">end</span>
0088             [fss1 fss2 err] = <a href="compareStructs.html" class="code" title="function [fs1, fs2, er] = compareStructs(s1,s2,n1,n2,p,tol)">compareStructs</a>(getfield(s1(jj),char(fn1(pnt1i(ii)))), <span class="keyword">...</span>
0089                                 getfield(s2(jj),char(fn2(pnt2i(ii)))),n1p,n2p,p);
0090             <span class="keyword">if</span> ~iscell(err); err = cellstr(err); <span class="keyword">end</span>
0091             fs1 = [fs1; fss1]; fs2 = [fs2; fss2]; er = [er; err];
0092         <span class="keyword">end</span>
0093     <span class="keyword">end</span>
0094 <span class="keyword">elseif</span> isstruct(s1) ~= isstruct(s2)
0095 <span class="comment">%    one structure, one not</span>
0096     disp(sprintf(<span class="string">'%s    %s        Type mismatch - NOT equal'</span>,n1,n2));
0097     fs1 = cell(0,1); fs2 = fs1;
0098     <span class="keyword">if</span> p; disp(<span class="string">'Paused .....'</span>); pause; <span class="keyword">end</span>
0099 <span class="keyword">elseif</span> isa(s1,<span class="string">'sym'</span>) &amp;&amp; isa(s2,<span class="string">'sym'</span>)
0100 <span class="comment">%    compare two symbolic expresions</span>
0101 <span class="comment">%    direct compare</span>
0102     [ss1 r] = simple(s1); [ss2 r] = simple(s2);
0103     t = isequal(simplify(ss1),simplify(ss2));
0104     <span class="keyword">if</span> ~t
0105 <span class="comment">%        could still be equal, but not able to reduce the symbolic expresions</span>
0106 <span class="comment">%        get factors</span>
0107         f1 = findsym(ss1); f2 = findsym(ss2);
0108         w = warning; 
0109         <span class="keyword">if</span> isequal(f1,f2)
0110 <span class="comment">%            same symbolic variables.  same eqn?</span>
0111             temp = [1 findstr(f1,<span class="string">' '</span>) + 1]; tres = NaN * zeros(1,30);
0112             <span class="keyword">for</span> jj = 1:1e3
0113                 ss1e = ss1; ss2e = ss2;
0114                 <span class="keyword">for</span> ii = 1:length(temp);
0115                     tv = (real(rand^rand)) / (real(rand^rand));
0116                     ss1e = subs(ss1e,f1(temp(ii)),tv);
0117                     ss2e = subs(ss2e,f2(temp(ii)),tv);
0118                 <span class="keyword">end</span>
0119     <span class="comment">%            check for match</span>
0120                 <span class="keyword">if</span> isnan(ss1e) || isnan(ss2e)
0121                     tres(jj) = 1;
0122                 <span class="keyword">elseif</span> (double(ss1e) - double(ss2e)) &lt; tol
0123                         tres(jj) = 1;
0124                 <span class="keyword">end</span>
0125             <span class="keyword">end</span>
0126 <span class="comment">%            now check symbolic equation results</span>
0127             <span class="keyword">if</span> sum(tres) == length(tres)
0128 <span class="comment">%                symbolics assumed to be the same equation</span>
0129                 t = 1;
0130             <span class="keyword">end</span>
0131         <span class="keyword">else</span>
0132 <span class="comment">%            different symbolic variables</span>
0133         <span class="keyword">end</span>
0134         warning(w)
0135     <span class="keyword">end</span>
0136     <span class="keyword">if</span> t
0137         disp(sprintf(<span class="string">'%s    %s        match'</span>,n1,n2))
0138     <span class="keyword">else</span>
0139         disp(sprintf(<span class="string">'%s    %s        do NOT match'</span>,n1,n2))
0140         fs1 = n1; fs2 = n2; er = <span class="string">'Symbolic disagreement'</span>;
0141     <span class="keyword">end</span>
0142 <span class="keyword">else</span>
0143 <span class="comment">%    neither structure - compare</span>
0144     <span class="keyword">if</span> isequal(s1,s2);
0145         <span class="comment">%disp(sprintf('%s     %s        match',n1,n2))</span>
0146     <span class="keyword">else</span>
0147 <span class="comment">%        check for &quot;false&quot; failures</span>
0148 <span class="comment">%        check structure size</span>
0149         <span class="keyword">if</span> strcmp(num2str(size(s1)),num2str(size(s2)));
0150 <span class="comment">%            structures are same size - check for precision error if numbers</span>
0151             <span class="keyword">if</span> ischar(s1) || iscell(s1) || <span class="keyword">...</span>
0152                 (max(max(max(abs(s1 - s2)))) &gt; tol * (max(max(max([s1 s2]))) <span class="keyword">...</span>
0153                 - min(min(min([s1 s2])))))
0154 <span class="comment">%                same size, diferent values or not numbers</span>
0155                 disp(sprintf(<span class="string">'%s    %s        do NOT match'</span>,n1,n2))
0156                 fs1 = [fs1; {n1}]; fs2 = [fs2; {n2}]; er = [er; {<span class="string">'?'</span>}];
0157                 <span class="keyword">if</span> ischar(s1)
0158                     er1 = sprintf(<span class="string">'%s is char - %s'</span>,n1,char(s1)); disp(er1);
0159                 <span class="keyword">end</span>
0160                 <span class="keyword">if</span> ischar(s2)
0161                     er2 = sprintf(<span class="string">'%s is char - %s'</span>,n2,char(s2)); disp(er2);
0162                 <span class="keyword">end</span>
0163                 <span class="keyword">if</span> exist(<span class="string">'er1'</span>,<span class="string">'var'</span>) &amp;&amp; exist(<span class="string">'er2'</span>,<span class="string">'var'</span>)
0164                     er = [er; {[er1 <span class="string">' ---&gt; '</span> er2]}];
0165                 <span class="keyword">end</span>
0166                 <span class="keyword">if</span> ~ischar(s1) &amp;&amp; ~iscell(s1);
0167                     er = sprintf(<span class="string">'Max error (%%) = %g%%'</span>, <span class="keyword">...</span>
0168                             max(max(max(abs(s1 - s2)))) / <span class="keyword">...</span>
0169                             (max(max(max([s1 s2]))) - min(min(min([s1 s2])))));
0170                     disp(er);
0171                 <span class="keyword">end</span>
0172                 <span class="keyword">if</span> p; disp(<span class="string">'Paused .....'</span>); pause; <span class="keyword">end</span>
0173             <span class="keyword">else</span>
0174 <span class="comment">%                tolerance agreement</span>
0175                 disp(sprintf(<span class="string">'%s     %s        tolerance match'</span>,n1,n2))
0176             <span class="keyword">end</span>
0177         <span class="keyword">else</span>
0178 <span class="comment">%            size difference</span>
0179             disp(sprintf(<span class="string">'%s    %s        do NOT match - DIFFERENT SIZES'</span>,n1,n2))
0180             fs1 = [fs1; {n1}]; fs2 = [fs2; {n2}]; er = [er; {<span class="string">'String size error'</span>}];
0181             <span class="keyword">if</span> p; disp(<span class="string">'Paused .....'</span>); pause; <span class="keyword">end</span>
0182         <span class="keyword">end</span>
0183     <span class="keyword">end</span>
0184 <span class="comment">%    fs1 = cell(0,1); fs2 = fs1;</span>
0185 <span class="keyword">end</span>
0186 
0187 <span class="comment">% display non matching fields</span>
0188 <span class="keyword">if</span> 1
0189     <span class="keyword">if</span> ~isempty(fs1)
0190         <span class="keyword">for</span> ii = 1:length(fs1)
0191             <span class="keyword">if</span> strcmp(n1,fs1(ii))
0192                 disp(sprintf(<span class="string">'First Structure non-matched fields:     %s'</span>,[n1]))
0193             <span class="keyword">else</span>
0194 <span class="comment">%                 if isempty(findstr(n1,char(fs1(ii))))</span>
0195 <span class="comment">%                     disp(sprintf('First Structure non-matched fields:     %s', ...</span>
0196 <span class="comment">%                                     [n1 '.' char(fs1(ii))]))</span>
0197 <span class="comment">%                 else</span>
0198 <span class="comment">%                     disp(sprintf('First Structure non-matched fields:     %s', ...</span>
0199 <span class="comment">%                                     [n1  strrep(char(fs1(ii)),n1,'')]))</span>
0200 <span class="comment">%                 end</span>
0201             <span class="keyword">end</span>
0202             <span class="keyword">if</span> p; disp(<span class="string">'Paused .....'</span>); pause; <span class="keyword">end</span>
0203         <span class="keyword">end</span>
0204     <span class="keyword">end</span>
0205     <span class="keyword">if</span> ~isempty(fs2)
0206         <span class="keyword">for</span> ii = 1:length(fs2)
0207             <span class="keyword">if</span> strcmp(n2,fs2(ii))
0208                 disp(sprintf(<span class="string">'Second Structure non-matched fields:     %s'</span>,[n2]))
0209             <span class="keyword">else</span>
0210 <span class="comment">%                 if isempty(findstr(n2,char(fs2(ii))))</span>
0211 <span class="comment">%                     disp(sprintf('Second Structure non-matched fields:     %s', ...</span>
0212 <span class="comment">%                                     [n2 '.' char(fs2(ii))]))</span>
0213 <span class="comment">%                 else</span>
0214 <span class="comment">%                     disp(sprintf('Second Structure non-matched fields:     %s', ...</span>
0215 <span class="comment">%                                     [n2  strrep(char(fs2(ii)),n2,'')]))</span>
0216 <span class="comment">%                 end</span>
0217             <span class="keyword">end</span>
0218             <span class="keyword">if</span> p; disp(<span class="string">'Paused .....'</span>); pause; <span class="keyword">end</span>
0219         <span class="keyword">end</span>
0220     <span class="keyword">end</span>
0221 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 05-May-2022 15:20:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>