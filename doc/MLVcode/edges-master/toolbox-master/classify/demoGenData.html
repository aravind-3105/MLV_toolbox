<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of demoGenData</title>
  <meta name="keywords" content="demoGenData">
  <meta name="description" content="Generate data drawn form a mixture of Gaussians.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">classify</a> &gt; demoGenData.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\classify&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>demoGenData
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Generate data drawn form a mixture of Gaussians.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [X0,H0,X1,H1] = demoGenData1(n0,n1,k,d,sep,ecc,frc) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Generate data drawn form a mixture of Gaussians.

 For definitions of separation and eccentricity see:
  Sanjoy Dasgupta, &quot;Learning Mixtures of Gaussians&quot;, FOCS, 1999.
  http://cseweb.ucsd.edu/~dasgupta/papers/mog.pdf

 USAGE
  [X0,H0,X1,H1] = demoGenData(n0,n1,k,d,sep,ecc,[frc])

 INPUTS
  n0     - size of training set
  n1     - size of testing set
  k      - number of mixture components
  d      - data dimension
  sep    - minimum separation degree between clusters (sep &gt; 0)
  ecc    - maximum eccentricity of clusters (0 &lt; ecc &lt; 1)
  frc    - [0] frac of points that are noise (uniformly distributed)

 OUTPUTS
  X0     - [n0xd] training set data vectors
  H0     - [n0x1] cluster membership in [1,k] (and -1 for noise)
  X1     - [n1xd] testing set data vectors
  H1     - [n1x1] cluster membership in [1,k] (and -1 for noise)

 EXAMPLE
  n0=1000; k=5; d=2; sep=2; ecc=1; frc=0;
  [X0,H0,X1,H1] = demoGenData(n0,n0,k,d,sep,ecc,frc);
  figure(1); clf; visualizeData( X0, 2, H0 ); title('train');
  figure(2); clf; visualizeData( X1, 2, H1 ); title('test');

 See also <a href="visualizeData.html" class="code" title="function visualizeData( X, k, IDX, types, C )">visualizeData</a>, <a href="demoCluster.html" class="code" title="">demoCluster</a>

 Piotr's Computer Vision Matlab Toolbox      Version 3.20
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="pdist2.html" class="code" title="function D = pdist2( X, Y, metric )">pdist2</a>	Calculates the distance between sets of vectors.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="demoCluster.html" class="code" title="">demoCluster</a>	Clustering demo.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [X0,H0,X1,H1] = demoGenData1(n0,n1,k,d,sep,ecc,frc)</a>
0002 <span class="comment">% Generate data drawn form a mixture of Gaussians.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% For definitions of separation and eccentricity see:</span>
0005 <span class="comment">%  Sanjoy Dasgupta, &quot;Learning Mixtures of Gaussians&quot;, FOCS, 1999.</span>
0006 <span class="comment">%  http://cseweb.ucsd.edu/~dasgupta/papers/mog.pdf</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% USAGE</span>
0009 <span class="comment">%  [X0,H0,X1,H1] = demoGenData(n0,n1,k,d,sep,ecc,[frc])</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% INPUTS</span>
0012 <span class="comment">%  n0     - size of training set</span>
0013 <span class="comment">%  n1     - size of testing set</span>
0014 <span class="comment">%  k      - number of mixture components</span>
0015 <span class="comment">%  d      - data dimension</span>
0016 <span class="comment">%  sep    - minimum separation degree between clusters (sep &gt; 0)</span>
0017 <span class="comment">%  ecc    - maximum eccentricity of clusters (0 &lt; ecc &lt; 1)</span>
0018 <span class="comment">%  frc    - [0] frac of points that are noise (uniformly distributed)</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% OUTPUTS</span>
0021 <span class="comment">%  X0     - [n0xd] training set data vectors</span>
0022 <span class="comment">%  H0     - [n0x1] cluster membership in [1,k] (and -1 for noise)</span>
0023 <span class="comment">%  X1     - [n1xd] testing set data vectors</span>
0024 <span class="comment">%  H1     - [n1x1] cluster membership in [1,k] (and -1 for noise)</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% EXAMPLE</span>
0027 <span class="comment">%  n0=1000; k=5; d=2; sep=2; ecc=1; frc=0;</span>
0028 <span class="comment">%  [X0,H0,X1,H1] = demoGenData(n0,n0,k,d,sep,ecc,frc);</span>
0029 <span class="comment">%  figure(1); clf; visualizeData( X0, 2, H0 ); title('train');</span>
0030 <span class="comment">%  figure(2); clf; visualizeData( X1, 2, H1 ); title('test');</span>
0031 <span class="comment">%</span>
0032 <span class="comment">% See also visualizeData, demoCluster</span>
0033 <span class="comment">%</span>
0034 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 3.20</span>
0035 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0036 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0037 
0038 <span class="comment">% generate mixing weights and adjust n0 and n1 for noise fraction</span>
0039 w=0; <span class="keyword">while</span>(any(w&lt;=1/(4*k))), w=rand(k,1); w=w/sum(w); <span class="keyword">end</span>
0040 <span class="keyword">if</span>( nargin&lt;7 ), frc=0; <span class="keyword">end</span>; frc=max(0,min(frc,1));
0041 n=floor(frc*n0); n0=n0-n; ns0=[ceil(n0*w); n];
0042 n=floor(frc*n1); n1=n1-n; ns1=[ceil(n1*w); n];
0043 
0044 <span class="comment">% create sep-separated Gaussian clusters of maximum eccentricity ecc</span>
0045 <span class="keyword">for</span> trial=1:1000
0046   lam = ones(k,1)/1000;
0047   n0=sum(ns0); X0=zeros(n0,d); H0=zeros(n0,1); n0=0;
0048   n1=sum(ns1); X1=zeros(n1,d); H1=zeros(n1,1); n1=0;
0049   mu = randn(k,d)*sqrt(k)*sqrt(sep)*trial/10;
0050   <span class="keyword">for</span> i = 1:k
0051     <span class="comment">% generate a random covariance matrix S=C'*C</span>
0052     U=rand(d,d)-0.5; U=sqrtm(inv(U*U'))*U;
0053     L=diag(rand(d,1)*(ecc-1)+1).^2/100; C=chol(U*L*U');
0054     <span class="comment">% populate X0, H0</span>
0055     n=ns0(i); X0j=randn(n,d)*C + mu(ones(n,1)*i,:);
0056     H0(n0+1:n0+n)=i; X0(n0+1:n0+n,:)=X0j; n0=n0+n;
0057     <span class="keyword">if</span>(n&gt;1), lam(i) = sqrt(trace(cov(X0j))); <span class="keyword">end</span>
0058     <span class="comment">% populate X1, H1</span>
0059     n=ns1(i); X1j=randn(n,d)*C + mu(ones(n,1)*i,:);
0060     H1(n1+1:n1+n)=i; X1(n1+1:n1+n,:)=X1j; n1=n1+n;
0061   <span class="keyword">end</span>
0062   <span class="comment">% check that degree of separation is sufficient (see Dasgupta 99)</span>
0063   <span class="comment">% use &quot;lam=sqrt(trace(S))&quot; instead of &quot;lam=sqrt(eigs(S,1))*d&quot;</span>
0064   S = <a href="pdist2.html" class="code" title="function D = pdist2( X, Y, metric )">pdist2</a>(mu,mu,<span class="string">'euclidean'</span>); S(eye(k)&gt;0)=inf;
0065   <span class="keyword">for</span> i=1:k, <span class="keyword">for</span> j=1:k, S(i,j)=S(i,j)/max(lam(i),lam(j)); <span class="keyword">end</span>; <span class="keyword">end</span>
0066   <span class="keyword">if</span>(all(S(:)&gt;=sep)), <span class="keyword">break</span>; <span class="keyword">end</span>
0067 <span class="keyword">end</span>; assert(trial&lt;1000);
0068 
0069 <span class="comment">% add uniformly distributed noise and permute order</span>
0070 <span class="keyword">if</span>( frc&gt;0 )
0071   v=max(abs(X0(:))); <span class="keyword">if</span>(n1), v=max(v,max(abs(X1(:)))); <span class="keyword">end</span>
0072   <span class="comment">% populate X0, H0</span>
0073   n=ns0(k+1); X0j=(rand(n,d)-.5)*v*2.5;
0074   H0(n0+1:n0+n)=-1; X0(n0+1:n0+n,:)=X0j;
0075   n0=n0+n; p=randperm(n0); X0=X0(p,:); H0=H0(p);
0076   <span class="comment">% populate X1, H1</span>
0077   n=ns1(k+1); X1j=(rand(n,d)-.5)*v*2.5;
0078   H1(n1+1:n1+n)=-1; X1(n1+1:n1+n,:)=X1j;
0079   n1=n1+n; p=randperm(n1); X1=X1(p,:); H1=H1(p);
0080 <span class="keyword">end</span>
0081 
0082 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 05-May-2022 15:20:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>