<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of nonMaxSupr</title>
  <meta name="keywords" content="nonMaxSupr">
  <meta name="description" content="Applies nonmaximal suppression on an image of arbitrary dimension.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">images</a> &gt; nonMaxSupr.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\images&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>nonMaxSupr
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Applies nonmaximal suppression on an image of arbitrary dimension.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [subs,vals] = nonMaxSupr( I, radii, thresh, maxn ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Applies nonmaximal suppression on an image of arbitrary dimension.

 nonMaxSupr( I, ... ) returns the pixel location and values of local
 maximums - that is a location is returned only if it has a value greater
 then or equal to all pixels in the surrounding window of size radii. I
 can be smoothed first to make method more robust. The first output is an
 array of the subscript locations of maximal values in I and the second
 output contains the corresponding maximal values.  One can convert
 subs/vals back to an array representation using subsToArray. Note that
 values are suppressed iff there are strictly greater values in the
 neighborhood.  Hences nonMaxSupr(ones(10),5) would not suppress any
 values. See also Example 3 for a trick for making <a href="nonMaxSupr.html" class="code" title="function [subs,vals] = nonMaxSupr( I, radii, thresh, maxn )">nonMaxSupr</a> fast (but
 possibly innacurate) for large radii (for n small).

 USAGE
  [subs,vals] = nonMaxSupr( I, radii, [thresh], [maxn] )

 INPUTS
  I       - matrix to apply <a href="nonMaxSupr.html" class="code" title="function [subs,vals] = nonMaxSupr( I, radii, thresh, maxn )">nonMaxSupr</a> to
  radii   - suppression window dimensions
  thresh  - [] minimum value below which not to look for maxes
  maxn:   - [0] return at most maxn of the largest vals

 OUTPUTS
  subs    - subscripts of non-suppressed point locations (n x d)
  vals    - values at non-suppressed point locations (n x 1)

 EXAMPLE - 1
  G = filterGauss( [25 25], [13,13], 3*eye(2), 1 );
  siz=[11 11]; G = filterGauss( siz, (siz+1)/2, eye(2), 1 );
  [subs,vals] = nonMaxSupr( G, 1, eps );
  figure(2); im( subsToArray( subs, vals, siz ) );
  [subs,vals] = nonMaxSuprList( ind2sub2(siz,(1:prod(siz))'), G(:)',1 );
  figure(3); im( subsToArray( subs, vals, siz ) );

 EXAMPLE - 2
  siz=[30 30]; I=ones(siz); I(22,23)=I(22,23)+3;
  I(12,23)=I(12,23)+5; I(7,1)=I(7,1)-.5; figure(1); im(I);
  r=3; suprEq = 1; maxn=[]; thresh=eps;
  [subs,vals] = nonMaxSupr(I,r,thresh,maxn);
  figure(2); im( subsToArray( subs, vals, siz ) );
  [subs,vals] = nonMaxSuprWin(subs,vals,[1 1]+6,siz-6);
  figure(3); im( subsToArray( subs, vals, siz ) );
  [subs2,vals2] = nonMaxSuprList( ind2sub2(siz,(1:prod(siz))'), ...
    I(:)',r,thresh,maxn,suprEq );
  figure(4); im( subsToArray( subs2, vals2, siz ) );

 EXAMPLE - 3
  I=abs(randn(1000)*50); I=I/max(I(:));
  I=gaussSmooth(I,10,'same',4); %note large radius
  figure(1); clf; im(I); hold on; radii=[50 50];
  tic, [subs1,vals1]=nonMaxSupr(I,[1 1],.1); toc
  tic, [subs1,vals1]=nonMaxSuprList(subs1,vals1,radii); toc
  plot(subs1(:,2),subs1(:,1),'+r');
  tic, [subs2,vals2]=nonMaxSupr(I,radii,.1); toc
  plot(subs2(:,2),subs2(:,1),'ob');

 See also SUBSTOARRAY, <a href="nonMaxSuprList.html" class="code" title="function [subs,vals,keep] = nonMaxSuprList( subs, vals, radii,thresh, maxn, flag)">NONMAXSUPRLIST</a>, <a href="nonMaxSuprWin.html" class="code" title="function [subs,vals,keepLocs] = nonMaxSuprWin( subs, vals,strLocs, endLocs, thresh, maxn )">NONMAXSUPRWIN</a>

 Piotr's Computer Vision Matlab Toolbox      Version 2.12
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [subs,vals] = nonMaxSupr( I, radii, thresh, maxn )</a>
0002 <span class="comment">% Applies nonmaximal suppression on an image of arbitrary dimension.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% nonMaxSupr( I, ... ) returns the pixel location and values of local</span>
0005 <span class="comment">% maximums - that is a location is returned only if it has a value greater</span>
0006 <span class="comment">% then or equal to all pixels in the surrounding window of size radii. I</span>
0007 <span class="comment">% can be smoothed first to make method more robust. The first output is an</span>
0008 <span class="comment">% array of the subscript locations of maximal values in I and the second</span>
0009 <span class="comment">% output contains the corresponding maximal values.  One can convert</span>
0010 <span class="comment">% subs/vals back to an array representation using subsToArray. Note that</span>
0011 <span class="comment">% values are suppressed iff there are strictly greater values in the</span>
0012 <span class="comment">% neighborhood.  Hences nonMaxSupr(ones(10),5) would not suppress any</span>
0013 <span class="comment">% values. See also Example 3 for a trick for making nonMaxSupr fast (but</span>
0014 <span class="comment">% possibly innacurate) for large radii (for n small).</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% USAGE</span>
0017 <span class="comment">%  [subs,vals] = nonMaxSupr( I, radii, [thresh], [maxn] )</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% INPUTS</span>
0020 <span class="comment">%  I       - matrix to apply nonMaxSupr to</span>
0021 <span class="comment">%  radii   - suppression window dimensions</span>
0022 <span class="comment">%  thresh  - [] minimum value below which not to look for maxes</span>
0023 <span class="comment">%  maxn:   - [0] return at most maxn of the largest vals</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% OUTPUTS</span>
0026 <span class="comment">%  subs    - subscripts of non-suppressed point locations (n x d)</span>
0027 <span class="comment">%  vals    - values at non-suppressed point locations (n x 1)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% EXAMPLE - 1</span>
0030 <span class="comment">%  G = filterGauss( [25 25], [13,13], 3*eye(2), 1 );</span>
0031 <span class="comment">%  siz=[11 11]; G = filterGauss( siz, (siz+1)/2, eye(2), 1 );</span>
0032 <span class="comment">%  [subs,vals] = nonMaxSupr( G, 1, eps );</span>
0033 <span class="comment">%  figure(2); im( subsToArray( subs, vals, siz ) );</span>
0034 <span class="comment">%  [subs,vals] = nonMaxSuprList( ind2sub2(siz,(1:prod(siz))'), G(:)',1 );</span>
0035 <span class="comment">%  figure(3); im( subsToArray( subs, vals, siz ) );</span>
0036 <span class="comment">%</span>
0037 <span class="comment">% EXAMPLE - 2</span>
0038 <span class="comment">%  siz=[30 30]; I=ones(siz); I(22,23)=I(22,23)+3;</span>
0039 <span class="comment">%  I(12,23)=I(12,23)+5; I(7,1)=I(7,1)-.5; figure(1); im(I);</span>
0040 <span class="comment">%  r=3; suprEq = 1; maxn=[]; thresh=eps;</span>
0041 <span class="comment">%  [subs,vals] = nonMaxSupr(I,r,thresh,maxn);</span>
0042 <span class="comment">%  figure(2); im( subsToArray( subs, vals, siz ) );</span>
0043 <span class="comment">%  [subs,vals] = nonMaxSuprWin(subs,vals,[1 1]+6,siz-6);</span>
0044 <span class="comment">%  figure(3); im( subsToArray( subs, vals, siz ) );</span>
0045 <span class="comment">%  [subs2,vals2] = nonMaxSuprList( ind2sub2(siz,(1:prod(siz))'), ...</span>
0046 <span class="comment">%    I(:)',r,thresh,maxn,suprEq );</span>
0047 <span class="comment">%  figure(4); im( subsToArray( subs2, vals2, siz ) );</span>
0048 <span class="comment">%</span>
0049 <span class="comment">% EXAMPLE - 3</span>
0050 <span class="comment">%  I=abs(randn(1000)*50); I=I/max(I(:));</span>
0051 <span class="comment">%  I=gaussSmooth(I,10,'same',4); %note large radius</span>
0052 <span class="comment">%  figure(1); clf; im(I); hold on; radii=[50 50];</span>
0053 <span class="comment">%  tic, [subs1,vals1]=nonMaxSupr(I,[1 1],.1); toc</span>
0054 <span class="comment">%  tic, [subs1,vals1]=nonMaxSuprList(subs1,vals1,radii); toc</span>
0055 <span class="comment">%  plot(subs1(:,2),subs1(:,1),'+r');</span>
0056 <span class="comment">%  tic, [subs2,vals2]=nonMaxSupr(I,radii,.1); toc</span>
0057 <span class="comment">%  plot(subs2(:,2),subs2(:,1),'ob');</span>
0058 <span class="comment">%</span>
0059 <span class="comment">% See also SUBSTOARRAY, NONMAXSUPRLIST, NONMAXSUPRWIN</span>
0060 <span class="comment">%</span>
0061 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 2.12</span>
0062 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0063 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0064 
0065 <span class="comment">% default values [error checking done by nlfiltersep_max]</span>
0066 <span class="keyword">if</span>( nargin&lt;3 || isempty(thresh)); thresh=min(I(:))-eps; <span class="keyword">end</span>;
0067 <span class="keyword">if</span>( nargin&lt;4 || isempty(maxn)); maxn = 0; <span class="keyword">end</span>;
0068 
0069 <span class="comment">% all the work is really done by nlfiltersep_max.m</span>
0070 IR = nlfiltersep( I, 2*radii+1, <span class="string">'same'</span>, @nlfiltersep_max );
0071 suprlocs = (I &lt; IR) | (I &lt;= thresh);
0072 
0073 <span class="comment">% create output accordingly</span>
0074 subs = find( suprlocs==0 );  vals = I( subs );
0075 [vals,order] = sort(-vals); vals=-vals; subs=subs(order);
0076 <span class="keyword">if</span>( ~isempty(maxn) &amp;&amp; maxn&gt;0 &amp;&amp; maxn&lt;length(vals) )
0077   subs = subs( 1:maxn ); vals = vals( 1:maxn );
0078 <span class="keyword">end</span>
0079 subs = ind2sub2(size(I),subs);</pre></div>
<hr><address>Generated on Thu 05-May-2022 15:20:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>