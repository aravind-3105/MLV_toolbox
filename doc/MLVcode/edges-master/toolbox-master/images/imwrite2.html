<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of imwrite2</title>
  <meta name="keywords" content="imwrite2">
  <meta name="description" content="Similar to imwrite, except follows a strict naming convention.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">images</a> &gt; imwrite2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\images&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>imwrite2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Similar to imwrite, except follows a strict naming convention.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function I = imwrite2( I, mulFlag, imagei, path,name, ext, nDigits, nSplits, spliti, varargin ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Similar to imwrite, except follows a strict naming convention.

 Wrapper for imwrite that writes file to the filename:
  fName = [path name int2str2(i,nDigits) '.' ext];
 Using imwrite:
  imwrite( I, fName, writePrms )
 If I represents a stack of images, the ith image is written to:
  fNamei = [path name int2str2(i+imagei-1,nDigits) '.' ext];
 If I=[], then imwrite2 will attempt to read images from disk instead.
 If dir spec. by 'path' does not exist, imwrite2 attempts to create it.

 mulFlag controls how I is interpreted.  If mulFlag==0, then I is
 intrepreted as a single image, otherwise I is interpreted as a stack of
 images, where I(:,:,...,j) represents the jth image (see fevalArrays for
 more info).

 If nSplits&gt;1, writes/reads images into/from multiple directories. This is
 useful since certain OS handle very large directories (of say &gt;20K
 images) rather poorly (I'm talking to you Bill).  Thus, can take 100K
 images, and write into 5 separate dirs, then read them back in.

 USAGE
   I = imwrite2( I, mulFlag, imagei, path, ...
     [name], [ext], [nDigits], [nSplits], [spliti], [varargin] )

 INPUTS
  I           - image or array or cell of images (if [] reads else writes)
  mulFlag     - set to 1 if I represents a stack of images
  imagei      - first image number
  path        - directory where images are
  name        - ['I'] base name of images
  ext         - ['png'] extension of image
  nDigits     - [5] number of digits for filename index
  nSplits     - [1] number of dirs to break data into
  spliti      - [0] first split (dir) number
  writePrms   - [varargin] parameters to imwrite

 OUTPUTS
  I           - image or images (read from disk if input I=[])

 EXAMPLE
  load images; I=images(:,:,1:10); clear IDXi IDXv t video videos images;
  imwrite2( I(:,:,1), 0, 0, 'rats/', 'rats', 'png', 5 );   % write 1
  imwrite2( I, 1, 0, 'rats/', 'rats', 'png', 5 );          % write 5
  I2 = imwrite2( [], 1, 0, 'rats/', 'rats', 'png', 5 );    % read 5
  I3 = fevalImages(@(x) x,{},'rats/','rats','png',0,4,5);  % read 5

 EXAMPLE - multiple splits
  load images; I=images(:,:,1:10); clear IDXi IDXv t video videos images;
  imwrite2( I, 1, 0, 'rats', 'rats', 'png', 5, 2, 0 );      % write 10
  I2=imwrite2( [], 1, 0, 'rats', 'rats', 'png', 5, 2, 0 );  % read 10

 See also FEVALIMAGES, FEVALARRAYS

 Piotr's Computer Vision Matlab Toolbox      Version 2.30
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="imwrite2.html" class="code" title="function I = imwrite2( I, mulFlag, imagei, path,name, ext, nDigits, nSplits, spliti, varargin )">imwrite2</a>	Similar to imwrite, except follows a strict naming convention.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="imwrite2.html" class="code" title="function I = imwrite2( I, mulFlag, imagei, path,name, ext, nDigits, nSplits, spliti, varargin )">imwrite2</a>	Similar to imwrite, except follows a strict naming convention.</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function varargout = imwrite2m( I, type, varargin )</a></li><li><a href="#_sub2" class="code">function imwrite2s( I, imagei, path, name, ext, nDigits, params )</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function I = imwrite2( I, mulFlag, imagei, path, </a><span class="keyword">...</span>
0002   name, ext, nDigits, nSplits, spliti, varargin )
0003 <span class="comment">% Similar to imwrite, except follows a strict naming convention.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Wrapper for imwrite that writes file to the filename:</span>
0006 <span class="comment">%  fName = [path name int2str2(i,nDigits) '.' ext];</span>
0007 <span class="comment">% Using imwrite:</span>
0008 <span class="comment">%  imwrite( I, fName, writePrms )</span>
0009 <span class="comment">% If I represents a stack of images, the ith image is written to:</span>
0010 <span class="comment">%  fNamei = [path name int2str2(i+imagei-1,nDigits) '.' ext];</span>
0011 <span class="comment">% If I=[], then imwrite2 will attempt to read images from disk instead.</span>
0012 <span class="comment">% If dir spec. by 'path' does not exist, imwrite2 attempts to create it.</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% mulFlag controls how I is interpreted.  If mulFlag==0, then I is</span>
0015 <span class="comment">% intrepreted as a single image, otherwise I is interpreted as a stack of</span>
0016 <span class="comment">% images, where I(:,:,...,j) represents the jth image (see fevalArrays for</span>
0017 <span class="comment">% more info).</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% If nSplits&gt;1, writes/reads images into/from multiple directories. This is</span>
0020 <span class="comment">% useful since certain OS handle very large directories (of say &gt;20K</span>
0021 <span class="comment">% images) rather poorly (I'm talking to you Bill).  Thus, can take 100K</span>
0022 <span class="comment">% images, and write into 5 separate dirs, then read them back in.</span>
0023 <span class="comment">%</span>
0024 <span class="comment">% USAGE</span>
0025 <span class="comment">%   I = imwrite2( I, mulFlag, imagei, path, ...</span>
0026 <span class="comment">%     [name], [ext], [nDigits], [nSplits], [spliti], [varargin] )</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% INPUTS</span>
0029 <span class="comment">%  I           - image or array or cell of images (if [] reads else writes)</span>
0030 <span class="comment">%  mulFlag     - set to 1 if I represents a stack of images</span>
0031 <span class="comment">%  imagei      - first image number</span>
0032 <span class="comment">%  path        - directory where images are</span>
0033 <span class="comment">%  name        - ['I'] base name of images</span>
0034 <span class="comment">%  ext         - ['png'] extension of image</span>
0035 <span class="comment">%  nDigits     - [5] number of digits for filename index</span>
0036 <span class="comment">%  nSplits     - [1] number of dirs to break data into</span>
0037 <span class="comment">%  spliti      - [0] first split (dir) number</span>
0038 <span class="comment">%  writePrms   - [varargin] parameters to imwrite</span>
0039 <span class="comment">%</span>
0040 <span class="comment">% OUTPUTS</span>
0041 <span class="comment">%  I           - image or images (read from disk if input I=[])</span>
0042 <span class="comment">%</span>
0043 <span class="comment">% EXAMPLE</span>
0044 <span class="comment">%  load images; I=images(:,:,1:10); clear IDXi IDXv t video videos images;</span>
0045 <span class="comment">%  imwrite2( I(:,:,1), 0, 0, 'rats/', 'rats', 'png', 5 );   % write 1</span>
0046 <span class="comment">%  imwrite2( I, 1, 0, 'rats/', 'rats', 'png', 5 );          % write 5</span>
0047 <span class="comment">%  I2 = imwrite2( [], 1, 0, 'rats/', 'rats', 'png', 5 );    % read 5</span>
0048 <span class="comment">%  I3 = fevalImages(@(x) x,{},'rats/','rats','png',0,4,5);  % read 5</span>
0049 <span class="comment">%</span>
0050 <span class="comment">% EXAMPLE - multiple splits</span>
0051 <span class="comment">%  load images; I=images(:,:,1:10); clear IDXi IDXv t video videos images;</span>
0052 <span class="comment">%  imwrite2( I, 1, 0, 'rats', 'rats', 'png', 5, 2, 0 );      % write 10</span>
0053 <span class="comment">%  I2=imwrite2( [], 1, 0, 'rats', 'rats', 'png', 5, 2, 0 );  % read 10</span>
0054 <span class="comment">%</span>
0055 <span class="comment">% See also FEVALIMAGES, FEVALARRAYS</span>
0056 <span class="comment">%</span>
0057 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 2.30</span>
0058 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0059 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0060 
0061 <span class="keyword">if</span>( nargin&lt;5 || isempty(name) );    name=<span class="string">'I'</span>; <span class="keyword">end</span>;
0062 <span class="keyword">if</span>( nargin&lt;6 || isempty(ext) );     ext=<span class="string">'png'</span>; <span class="keyword">end</span>;
0063 <span class="keyword">if</span>( nargin&lt;7 || isempty(nDigits) ); nDigits=5; <span class="keyword">end</span>;
0064 <span class="keyword">if</span>( nargin&lt;8 || isempty(nSplits) ); nSplits=1; <span class="keyword">end</span>;
0065 <span class="keyword">if</span>( nargin&lt;9 || isempty(spliti) );  spliti=0; <span class="keyword">end</span>;
0066 n = size(I,3);  <span class="keyword">if</span>(isempty(I)); n=0; <span class="keyword">end</span>
0067 
0068 <span class="comment">% multiple splits -- call imwrite2 recursively</span>
0069 <span class="keyword">if</span>( nSplits&gt;1 )
0070   write2inp = [ {name, ext, nDigits, 1, 0} varargin ];
0071   <span class="keyword">if</span>(n&gt;0); nSplits=min(n,nSplits); <span class="keyword">end</span>;
0072   <span class="keyword">for</span> s=1:nSplits
0073     pathS = [path int2str2(s-1+spliti,2)];
0074     <span class="keyword">if</span>( n&gt;0 ) <span class="comment">% write</span>
0075       nPerDir = ceil( n / nSplits );
0076       ISplit = I(:,:,1:min(<span class="keyword">end</span>,nPerDir));
0077       <a href="imwrite2.html" class="code" title="function I = imwrite2( I, mulFlag, imagei, path,name, ext, nDigits, nSplits, spliti, varargin )">imwrite2</a>( ISplit, nPerDir&gt;1, 0, pathS, write2inp{:} );
0078       <span class="keyword">if</span>( s~=nSplits ); I = I(:,:,(nPerDir+1):end); <span class="keyword">end</span>
0079     <span class="keyword">else</span> <span class="comment">% read</span>
0080       ISplit = <a href="imwrite2.html" class="code" title="function I = imwrite2( I, mulFlag, imagei, path,name, ext, nDigits, nSplits, spliti, varargin )">imwrite2</a>( [], 1, 0, pathS, write2inp{:} );
0081       I = cat(3,I,ISplit);
0082     <span class="keyword">end</span>
0083   <span class="keyword">end</span>
0084   <span class="keyword">return</span>;
0085 <span class="keyword">end</span>
0086 
0087 <span class="comment">% if I is empty read from disk</span>
0088 <span class="keyword">if</span>( n==0 )
0089   I = fevalImages( @(x) x, {}, path, name, ext, imagei, [], nDigits );
0090   <span class="keyword">return</span>;
0091 <span class="keyword">end</span>
0092 
0093 <span class="comment">% Check if path exists (create if not) and add '/' at end if needed</span>
0094 <span class="keyword">if</span>( ~isempty(path) )
0095   <span class="keyword">if</span>(~exist(path,<span class="string">'dir'</span>))
0096     warning( [<span class="string">'creating directory: '</span> path] ); <span class="comment">%#ok&lt;WNTAG&gt;</span>
0097     mkdir( path );
0098   <span class="keyword">end</span>;
0099   <span class="keyword">if</span>( path(end)~=<span class="string">'\'</span> &amp;&amp; path(end)~=<span class="string">'/'</span> ); path(end+1) = <span class="string">'/'</span>; <span class="keyword">end</span>
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">% Write images using one of the two subfunctions</span>
0103 params = varargin;
0104 <span class="keyword">if</span>( mulFlag )
0105   <a href="#_sub1" class="code" title="subfunction varargout = imwrite2m( I, type, varargin )">imwrite2m</a>( [], <span class="string">'init'</span>, imagei, path, name, ext, nDigits, params );
0106   <span class="keyword">if</span>( ~iscell(I) )
0107     fevalArrays( I, @<a href="#_sub1" class="code" title="subfunction varargout = imwrite2m( I, type, varargin )">imwrite2m</a>, <span class="string">'write'</span> );
0108   <span class="keyword">else</span>
0109     fevalArrays( I, @(x) <a href="#_sub1" class="code" title="subfunction varargout = imwrite2m( I, type, varargin )">imwrite2m</a>(x{1},<span class="string">'write'</span>) );
0110   <span class="keyword">end</span>
0111 <span class="keyword">else</span>
0112   <span class="keyword">if</span>( ~iscell(I) )
0113     <a href="#_sub2" class="code" title="subfunction imwrite2s( I, imagei, path, name, ext, nDigits, params )">imwrite2s</a>( I, imagei, path, name, ext, nDigits, params );
0114   <span class="keyword">else</span>
0115     <a href="#_sub2" class="code" title="subfunction imwrite2s( I, imagei, path, name, ext, nDigits, params )">imwrite2s</a>( I{1}, imagei, path, name, ext, nDigits, params );
0116   <span class="keyword">end</span>;
0117 <span class="keyword">end</span>
0118 
0119 <a name="_sub1" href="#_subfunctions" class="code">function varargout = imwrite2m( I, type, varargin )</a>
0120 <span class="comment">% helper for writing multiple images (passed to fevalArrays)</span>
0121 
0122 <span class="keyword">persistent</span> imagei path name ext nDigits params
0123 <span class="keyword">switch</span> type
0124   <span class="keyword">case</span> <span class="string">'init'</span>
0125     narginchk(8,8);
0126     [nstart, path, name, ext, nDigits, params] = deal(varargin{:});
0127     <span class="keyword">if</span>(isempty(nstart)); imagei=0; <span class="keyword">else</span> imagei=nstart; <span class="keyword">end</span>
0128     varargout = {[]};
0129 
0130   <span class="keyword">case</span> <span class="string">'write'</span>
0131     narginchk(2,2);
0132     <a href="#_sub2" class="code" title="subfunction imwrite2s( I, imagei, path, name, ext, nDigits, params )">imwrite2s</a>( I, imagei, path, name, ext, nDigits, params );
0133     imagei = imagei+1;
0134     varargout = {[]};
0135 <span class="keyword">end</span>
0136 
0137 <a name="_sub2" href="#_subfunctions" class="code">function imwrite2s( I, imagei, path, name, ext, nDigits, params )</a>
0138 <span class="comment">% helper for writing a single image</span>
0139 
0140 fullname = [path name int2str2(imagei,nDigits) <span class="string">'.'</span> ext];
0141 imwrite( I, fullname, params{:} );</pre></div>
<hr><address>Generated on Thu 05-May-2022 15:20:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>