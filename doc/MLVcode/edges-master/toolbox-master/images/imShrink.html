<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of imShrink</title>
  <meta name="keywords" content="imShrink">
  <meta name="description" content="Used to shrink a multidimensional array I by integer amount.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">images</a> &gt; imShrink.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\images&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>imShrink
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Used to shrink a multidimensional array I by integer amount.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function I = imShrink( I, ratios ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Used to shrink a multidimensional array I by integer amount.

 ratios specifies block dimensions. For example, ratios=[2 3 4] shrinks a
 3 dimensional array I by a factor of 2 along the first dimension, 3 along
 the secong and 4 along the third. ratios must be positive integers. A
 value of 1 means no shrinking is done along a given dimension. Can handle
 very large arrays in a memory efficient manner. All the work is done by
 localSum with the 'block' shape flag. Note that for downsampling by 2x or
 4x for 2D arrays imResample is much faster.

 USAGE
  I = imShrink( I, ratios )

 INPUTS
  I       - k dimensional input array
  ratios  - k element int vector of shrinking factors

 OUTPUTS
  I       - shrunk version of input

 EXAMPLE
  load trees; I=ind2gray(X,map);
  I2 = imShrink( I, [2 2] );
  figure(1); im(I); figure(2); im(I2);

 See also imResample, <a href="localSum.html" class="code" title="function I = localSum( I, dims, shape, op )">localSum</a>

 Piotr's Computer Vision Matlab Toolbox      Version 3.00
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="imShrink.html" class="code" title="function I = imShrink( I, ratios )">imShrink</a>	Used to shrink a multidimensional array I by integer amount.</li><li><a href="localSum.html" class="code" title="function I = localSum( I, dims, shape, op )">localSum</a>	Fast routine for box, max and min filtering.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="imShrink.html" class="code" title="function I = imShrink( I, ratios )">imShrink</a>	Used to shrink a multidimensional array I by integer amount.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function I = imShrink( I, ratios )</a>
0002 <span class="comment">% Used to shrink a multidimensional array I by integer amount.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% ratios specifies block dimensions. For example, ratios=[2 3 4] shrinks a</span>
0005 <span class="comment">% 3 dimensional array I by a factor of 2 along the first dimension, 3 along</span>
0006 <span class="comment">% the secong and 4 along the third. ratios must be positive integers. A</span>
0007 <span class="comment">% value of 1 means no shrinking is done along a given dimension. Can handle</span>
0008 <span class="comment">% very large arrays in a memory efficient manner. All the work is done by</span>
0009 <span class="comment">% localSum with the 'block' shape flag. Note that for downsampling by 2x or</span>
0010 <span class="comment">% 4x for 2D arrays imResample is much faster.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% USAGE</span>
0013 <span class="comment">%  I = imShrink( I, ratios )</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% INPUTS</span>
0016 <span class="comment">%  I       - k dimensional input array</span>
0017 <span class="comment">%  ratios  - k element int vector of shrinking factors</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% OUTPUTS</span>
0020 <span class="comment">%  I       - shrunk version of input</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% EXAMPLE</span>
0023 <span class="comment">%  load trees; I=ind2gray(X,map);</span>
0024 <span class="comment">%  I2 = imShrink( I, [2 2] );</span>
0025 <span class="comment">%  figure(1); im(I); figure(2); im(I2);</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% See also imResample, localSum</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 3.00</span>
0030 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0031 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0032 
0033 <span class="keyword">if</span>( all(ratios==1) ); <span class="keyword">return</span>; <span class="keyword">end</span>
0034 siz = size(I);  nd = ndims(I);
0035 <span class="keyword">while</span>( length(ratios)&gt;nd &amp;&amp; ratios(end)==1 ); ratios=ratios(1:end-1); <span class="keyword">end</span>
0036 [ratios,er] = checkNumArgs( ratios, [1 nd], 0, 2 ); error(er);
0037 
0038 <span class="comment">% trim I to have integer number of blocks</span>
0039 ratios = min(ratios,siz); siz = siz - mod( siz, ratios );
0040 <span class="keyword">if</span> (~all( siz==size(I))); I = arrayCrop( I, ones(1,nd), siz ); <span class="keyword">end</span>
0041 
0042 <span class="comment">% if memory is large, recursively call on subparts and recombine</span>
0043 <span class="keyword">if</span>( prod(siz)*8e-6 &gt; 200 ) <span class="comment">% set max at 200MB, splits add overhead</span>
0044   d = randint2(1,1,[1 nd]);  nblocks = siz(d)/ratios(d);
0045   <span class="keyword">if</span>( nblocks==1 ); I = <a href="imShrink.html" class="code" title="function I = imShrink( I, ratios )">imShrink</a>( I, ratios ); <span class="keyword">return</span>; <span class="keyword">end</span>
0046   midblock = floor(nblocks/2) * ratios(d);
0047   inds = {<span class="string">':'</span>}; inds = inds(:,ones(1,nd));
0048   inds1 = inds; inds1{d}=1:midblock;
0049   inds2 = inds; inds2{d}=midblock+1:siz(d);
0050   I1 = <a href="imShrink.html" class="code" title="function I = imShrink( I, ratios )">imShrink</a>( I(inds1{:}), ratios );
0051   I2 = <a href="imShrink.html" class="code" title="function I = imShrink( I, ratios )">imShrink</a>( I(inds2{:}), ratios );
0052   I = cat( d, I1, I2 ); <span class="keyword">return</span>;
0053 <span class="keyword">end</span>
0054 
0055 <span class="comment">% run localSum then divide by prod( ratios )</span>
0056 classname = class( I );
0057 I = double(I);
0058 I = <a href="localSum.html" class="code" title="function I = localSum( I, dims, shape, op )">localSum</a>( I, ratios, <span class="string">'block'</span> );
0059 I = I * (1/prod( ratios ));
0060 I = feval( classname, I );
0061 
0062 <span class="comment">% SLOW / BROKEN - gaussian version of above gauss controls whether the</span>
0063 <span class="comment">% smoothing is done by a gaussian or averaging window.  Using an averaging</span>
0064 <span class="comment">% window (gauss==0) is equivalent to dividing the array into</span>
0065 <span class="comment">% non-overlapping cube shaped blocks.  Using a gaussian is equivalent to</span>
0066 <span class="comment">% using slightly overlapping elliptical blocks. In this case the standard</span>
0067 <span class="comment">% deviations of the gaussians are automatically determined from ratios.</span>
0068 <span class="comment">% NOTE: sigmas are set to ratios/2/1.6.  Is this ideal?</span>
0069 <span class="comment">%</span>
0070 <span class="comment">% The array is first smoothed, then it is subsampled.  An equivalent way to</span>
0071 <span class="comment">% think of this operation is that the array is divided into a series of</span>
0072 <span class="comment">% blocks (with minimal or no overlap), and then each block is replaced by</span>
0073 <span class="comment">% its average.</span>
0074 <span class="comment">%</span>
0075 <span class="comment">% if(gauss)</span>
0076 <span class="comment">%   % get smoothed version of I</span>
0077 <span class="comment">%   sigmas = ratios/2 / 1.6; sigmas(ratios==1)=0; %is this ideal sigmas?</span>
0078 <span class="comment">%   I = gaussSmooth( I, sigmas, 'full' );</span>
0079 <span class="comment">%   I = arrayToDims( I, siz-ratios+1 );</span>
0080 <span class="comment">%</span>
0081 <span class="comment">%   % now subsample smoothed I</span>
0082 <span class="comment">%   sizsum = size(I);</span>
0083 <span class="comment">%   extract={}; for d=1:nd extract{d}=1:ratios(d):sizsum(d); end;</span>
0084 <span class="comment">%   I = I( extract{:} );</span>
0085 <span class="comment">% end</span></pre></div>
<hr><address>Generated on Thu 05-May-2022 15:20:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>