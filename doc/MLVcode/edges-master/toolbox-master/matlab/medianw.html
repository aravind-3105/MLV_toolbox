<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of medianw</title>
  <meta name="keywords" content="medianw">
  <meta name="description" content="Fast weighted median.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">matlab</a> &gt; medianw.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\matlab&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>medianw
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Fast weighted median.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function m = medianw( x, w, dim ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Fast weighted median.

 Computes the weighted median of a set of samples.
  http://en.wikipedia.org/wiki/Weighted_median
 &quot;A weighted median of a sample is the 50% weighted percentile.&quot;
 For matrices computes median along each column (or dimension dim).
 If all weights are equal to 1 gives identical results to median.

 USAGE
  m = medianw( x, w, [dim] )

 INPUTS
  x      - vector or array of samples
  w      - vector or array of weights
  dim    - dimension along which to compute median

 OUTPUTS
  m      - weighted median value of x

 EXAMPLE - simple toy example
  x=[1 2 3]; w=[1 1 5]; medianw(x,w)

 EXAMPLE - comparison to median
  n=randi(100); m=randi(100);
  x=rand(n,m); w=ones(n,m);
  m1=median(x); m2=medianw(x,w);
  assert(isequal(m1,m2))

 See also median

 Piotr's Computer Vision Matlab Toolbox      Version 3.24
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function m = medianw( x, w, dim )</a>
0002 <span class="comment">% Fast weighted median.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Computes the weighted median of a set of samples.</span>
0005 <span class="comment">%  http://en.wikipedia.org/wiki/Weighted_median</span>
0006 <span class="comment">% &quot;A weighted median of a sample is the 50% weighted percentile.&quot;</span>
0007 <span class="comment">% For matrices computes median along each column (or dimension dim).</span>
0008 <span class="comment">% If all weights are equal to 1 gives identical results to median.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% USAGE</span>
0011 <span class="comment">%  m = medianw( x, w, [dim] )</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% INPUTS</span>
0014 <span class="comment">%  x      - vector or array of samples</span>
0015 <span class="comment">%  w      - vector or array of weights</span>
0016 <span class="comment">%  dim    - dimension along which to compute median</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% OUTPUTS</span>
0019 <span class="comment">%  m      - weighted median value of x</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% EXAMPLE - simple toy example</span>
0022 <span class="comment">%  x=[1 2 3]; w=[1 1 5]; medianw(x,w)</span>
0023 <span class="comment">%</span>
0024 <span class="comment">% EXAMPLE - comparison to median</span>
0025 <span class="comment">%  n=randi(100); m=randi(100);</span>
0026 <span class="comment">%  x=rand(n,m); w=ones(n,m);</span>
0027 <span class="comment">%  m1=median(x); m2=medianw(x,w);</span>
0028 <span class="comment">%  assert(isequal(m1,m2))</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% See also median</span>
0031 <span class="comment">%</span>
0032 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 3.24</span>
0033 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0034 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0035 
0036 <span class="keyword">if</span>(nargin&lt;3), dim=find(size(x)~=1,1); <span class="keyword">end</span>
0037 d=dim; nd=ndims(x); n=numel(x);
0038 
0039 <span class="keyword">if</span>( n==1 || size(x,d)==1 )
0040   m=x;
0041 <span class="keyword">elseif</span>( length(x)==n )
0042   [x,o]=sort(x); w=w(o); w=cumsum(w);
0043   w=w/w(end); [~,j]=min(w&lt;=.5);
0044   <span class="keyword">if</span>(j==1 || w(j-1)~=.5), m=x(j);
0045   <span class="keyword">else</span> m=(x(j-1)+x(j))/2; <span class="keyword">end</span>
0046 <span class="keyword">else</span>
0047   <span class="keyword">if</span>(d&gt;1), p=[d 1:d-1 d+1:nd]; x=permute(x,p); w=permute(w,p); <span class="keyword">end</span>
0048   [x,o]=sort(x); w=w(o); w=cumsum(w); is={<span class="string">':'</span>}; is=is(ones(1,nd-1));
0049   w=bsxfun(@rdivide,w,w(<span class="keyword">end</span>,is{:})); [~,j]=min(w&lt;=.5);
0050   s=size(x); s=reshape(((1:n/s(1))-1)*s(1),size(j));
0051   j0=max(1,j-1); j0=j0+s; j=j+s;
0052   same=w(j0)~=.5; j0(same)=j(same); m=(x(j0)+x(j))/2;
0053   <span class="keyword">if</span>(d&gt;1), p=[2:d 1 d+1:nd]; m=permute(m,p); <span class="keyword">end</span>
0054 <span class="keyword">end</span>
0055 
0056 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 05-May-2022 14:52:24 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>