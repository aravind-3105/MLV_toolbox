<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of fevalMats</title>
  <meta name="keywords" content="fevalMats">
  <meta name="description" content="Used to apply the same operation to all .mat files in given directory.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">matlab</a> &gt; fevalMats.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\matlab&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>fevalMats
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Used to apply the same operation to all .mat files in given directory.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function X = fevalMats( fHandle, matCont, prm, srcDir, prefix ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Used to apply the same operation to all .mat files in given directory.

 For each mat in srcDir, loads the mat file, extracts the variables
 denoted by matCont, applies the function fHandle and stores the
 result.  matCont must be a cell array of strings, where each string
 denotes the variable stored in the mat files. For example, if each mat
 file contains two variables y and z, then matCont should be
 {'y','z'}.  For long operations shows progress info.

 fHandle must point to a function that takes two inputs: vals and prm.
 vals is a cell array that contains the values for the variables denoted
 by matCont and contained in the mat file, and prm are the
 additional static parameters passed to fevalArrays.  Continuing the
 example above vals would be {y,z} - (use deal to extract):
  x=feval(fHandle,{y,z},prm)
 Each returned x must have the same dimensions, X is a concatentation of
 the returned x's along the (d+1) dimension.

 USAGE
  X = fevalMats( fHandle, matCont, prm, srcDir, [prefix] )

 INPUTS
  fHandle  - function to apply to contents of each mat file [see above]
  matCont  - cell array of strings of expected contents of each mat file
  prm      - cell array of additional parameters to fHandle (may be {})
  srcDir   - directory containg mat files
  prefix   - [] only consider mat files in srcDir of the form prefix_*.mat

 OUTPUTS
  X        - output array [see above]

 EXAMPLE

 See also <a href="fevalImages.html" class="code" title="function X = fevalImages( fHandle, prms, srcDir, name, ext,nStr, nEnd, nDigits )">FEVALIMAGES</a>, <a href="fevalArrays.html" class="code" title="function B = fevalArrays( A, fHandle, varargin )">FEVALARRAYS</a>, DEAL

 Piotr's Computer Vision Matlab Toolbox      Version 2.0
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="ticStatus.html" class="code" title="function id = ticStatus( msg, updateFreq, updateMinT, erasePrev )">ticStatus</a>	Used to display the progress of a long process.</li><li><a href="tocStatus.html" class="code" title="function tocStatus( id, fracDone )">tocStatus</a>	Used to display the progress of a long process.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function X = fevalMats( fHandle, matCont, prm, srcDir, prefix )</a>
0002 <span class="comment">% Used to apply the same operation to all .mat files in given directory.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% For each mat in srcDir, loads the mat file, extracts the variables</span>
0005 <span class="comment">% denoted by matCont, applies the function fHandle and stores the</span>
0006 <span class="comment">% result.  matCont must be a cell array of strings, where each string</span>
0007 <span class="comment">% denotes the variable stored in the mat files. For example, if each mat</span>
0008 <span class="comment">% file contains two variables y and z, then matCont should be</span>
0009 <span class="comment">% {'y','z'}.  For long operations shows progress info.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% fHandle must point to a function that takes two inputs: vals and prm.</span>
0012 <span class="comment">% vals is a cell array that contains the values for the variables denoted</span>
0013 <span class="comment">% by matCont and contained in the mat file, and prm are the</span>
0014 <span class="comment">% additional static parameters passed to fevalArrays.  Continuing the</span>
0015 <span class="comment">% example above vals would be {y,z} - (use deal to extract):</span>
0016 <span class="comment">%  x=feval(fHandle,{y,z},prm)</span>
0017 <span class="comment">% Each returned x must have the same dimensions, X is a concatentation of</span>
0018 <span class="comment">% the returned x's along the (d+1) dimension.</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% USAGE</span>
0021 <span class="comment">%  X = fevalMats( fHandle, matCont, prm, srcDir, [prefix] )</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% INPUTS</span>
0024 <span class="comment">%  fHandle  - function to apply to contents of each mat file [see above]</span>
0025 <span class="comment">%  matCont  - cell array of strings of expected contents of each mat file</span>
0026 <span class="comment">%  prm      - cell array of additional parameters to fHandle (may be {})</span>
0027 <span class="comment">%  srcDir   - directory containg mat files</span>
0028 <span class="comment">%  prefix   - [] only consider mat files in srcDir of the form prefix_*.mat</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% OUTPUTS</span>
0031 <span class="comment">%  X        - output array [see above]</span>
0032 <span class="comment">%</span>
0033 <span class="comment">% EXAMPLE</span>
0034 <span class="comment">%</span>
0035 <span class="comment">% See also FEVALIMAGES, FEVALARRAYS, DEAL</span>
0036 <span class="comment">%</span>
0037 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 2.0</span>
0038 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0039 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0040 
0041 narginchk( 4, 5 );
0042 
0043 <span class="comment">%%% Check if srcDir is valid and add '/' at end if needed</span>
0044 <span class="keyword">if</span>( ~isempty(srcDir) )
0045   <span class="keyword">if</span>(~exist(srcDir,<span class="string">'dir'</span>));
0046     error([<span class="string">'fevalMats: dir '</span> srcDir <span class="string">' not found'</span>]); <span class="keyword">end</span>
0047   <span class="keyword">if</span>( srcDir(end)~=<span class="string">'\'</span> &amp;&amp; srcDir(end)~=<span class="string">'/'</span> ); srcDir(end+1) = <span class="string">'/'</span>; <span class="keyword">end</span>
0048 <span class="keyword">end</span>
0049 
0050 <span class="comment">%%% get appropriate fileNames</span>
0051 <span class="keyword">if</span>( nargin&lt;=4 || isempty(prefix) )
0052   dirCont = dir( [srcDir <span class="string">'*.mat'</span>] );
0053 <span class="keyword">else</span>
0054   dirCont = dir( [srcDir prefix <span class="string">'_*.mat'</span>] );
0055 <span class="keyword">end</span>
0056 fileNames = {dirCont.name}; n = length(dirCont);
0057 <span class="keyword">if</span>( n==0 ); error( [<span class="string">'No appropriate mat files found in '</span> srcDir] ); <span class="keyword">end</span>
0058 
0059 <span class="comment">%%% load each mat file and apply fHandle</span>
0060 ticId = <a href="ticStatus.html" class="code" title="function id = ticStatus( msg, updateFreq, updateMinT, erasePrev )">ticStatus</a>(<span class="string">'fevalMats'</span>,[],40);
0061 nCont = length( matCont );
0062 <span class="keyword">for</span> i=1:n
0063   <span class="comment">% load mat file and get contents</span>
0064   S = load( [srcDir fileNames{i}] );
0065   errmsg = [<span class="string">'Unexpected contents for mat file: '</span> fileNames{i}];
0066   <span class="keyword">if</span>( length(fieldnames(S))&lt;nCont); error( errmsg ); <span class="keyword">end</span>
0067   inputs = cell(1,nCont);
0068   <span class="keyword">for</span> j=1:nCont
0069     <span class="keyword">if</span>( ~isfield(S,matCont{j}) ); error( errmsg ); <span class="keyword">end</span>
0070     inputs{j} = S.(matCont{j});
0071   <span class="keyword">end</span>; clear S;
0072 
0073   <span class="comment">% apply fHandle</span>
0074   x = feval( fHandle, inputs, prm );
0075   <span class="keyword">if</span> (i==1)
0076     ndx = ndims(x);
0077     <span class="keyword">if</span>(ndx==2 &amp;&amp; size(x,2)==1); ndx=1; <span class="keyword">end</span>;
0078     onesNdx = ones(1,ndx);
0079     X = repmat( x, [onesNdx,n] );
0080     indsX = {<span class="string">':'</span>}; indsX = indsX(onesNdx);
0081   <span class="keyword">else</span>
0082     X(indsX{:},i) = x;
0083   <span class="keyword">end</span>;
0084   <a href="tocStatus.html" class="code" title="function tocStatus( id, fracDone )">tocStatus</a>( ticId, i/n );
0085 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 05-May-2022 14:52:24 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>