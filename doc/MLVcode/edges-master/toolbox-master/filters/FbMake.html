<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of FbMake</title>
  <meta name="keywords" content="FbMake">
  <meta name="description" content="Various 1D/2D/3D filterbanks (hardcoded).">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">MLVcode</a> &gt; <a href="../../index.html">edges-master</a> &gt; <a href="#">toolbox-master</a> &gt; <a href="index.html">filters</a> &gt; FbMake.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for MLVcode\edges-master\toolbox-master\filters&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>FbMake
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>Various 1D/2D/3D filterbanks (hardcoded).</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function FB = FbMake( dim, flag, show ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Various 1D/2D/3D filterbanks (hardcoded).

 USAGE
  FB = FbMake( dim, flag, [show] )

 INPUTS
  dim     - dimension
  flag    - controls type of filterbank to create
          - if d==1
            1: gabor filter bank for spatiotemporal stuff
          - if d==2
            1: filter bank from Serge Belongie
            2: 1st/2nd order DooG filters.  Similar to Gabor filterbank.
            3: similar to Laptev&amp;Lindberg ICPR04
            4: decent seperable steerable? filterbank
            5: berkeley filterbank for textons papers
            6: symmetric DOOG filters
          - if d==3
            1: decent seperable steerable filterbank
  show    - [0] figure to use for optional display

 OUTPUTS

 EXAMPLE
  FB = FbMake( 2, 1, 1 ); 

 See also <a href="FbApply2d.html" class="code" title="function FR = FbApply2d( I, FB, shape, show )">FBAPPLY2D</a>

 Piotr's Computer Vision Matlab Toolbox      Version 2.0
 Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]
 Licensed under the Simplified BSD License [see external/bsd.txt]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="FbVisualize.html" class="code" title="function FbVisualize( FB, show )">FbVisualize</a>	Used to visualize a series of 1D/2D/3D filters.</li><li><a href="filterDog2d.html" class="code" title="function G = filterDog2d( r, var, order, show )">filterDog2d</a>	Difference of Gaussian (Dog) Filter.</li><li><a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>	n-dim difference of offset Gaussian DooG filter (Gaussian derivative).</li><li><a href="filterGabor1d.html" class="code" title="function [feven,fodd] = filterGabor1d( r, sig, omega, show )">filterGabor1d</a>	Creates an even/odd pair of 1D Gabor filters.</li><li><a href="filterGabor2d.html" class="code" title="function [Feven,Fodd] = filterGabor2d( r, sig, lam, theta, omega, show )">filterGabor2d</a>	Creates an even/odd pair of 2D Gabor filters.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function FB = FbMake1D( flag )</a></li><li><a href="#_sub2" class="code">function FB = FbMakegabor1D( r, sigmas, omegas )</a></li><li><a href="#_sub3" class="code">function FB = FbMake2D( flag )</a></li><li><a href="#_sub4" class="code">function FB = FbMakegabor( r, nOrient, nScales, lambda, sigma )</a></li><li><a href="#_sub5" class="code">function FB = FbMakeDooGSym( r, nOrient, sigs )</a></li><li><a href="#_sub6" class="code">function FB = FbMakeDooG( r, nOrient, nScales, lambda, sigma )</a></li><li><a href="#_sub7" class="code">function FB = FbMakeDOG( r, sigmaStr, sigmaEnd, n )</a></li><li><a href="#_sub8" class="code">function FB = FbMake3d( flag )</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function FB = FbMake( dim, flag, show )</a>
0002 <span class="comment">% Various 1D/2D/3D filterbanks (hardcoded).</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% USAGE</span>
0005 <span class="comment">%  FB = FbMake( dim, flag, [show] )</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% INPUTS</span>
0008 <span class="comment">%  dim     - dimension</span>
0009 <span class="comment">%  flag    - controls type of filterbank to create</span>
0010 <span class="comment">%          - if d==1</span>
0011 <span class="comment">%            1: gabor filter bank for spatiotemporal stuff</span>
0012 <span class="comment">%          - if d==2</span>
0013 <span class="comment">%            1: filter bank from Serge Belongie</span>
0014 <span class="comment">%            2: 1st/2nd order DooG filters.  Similar to Gabor filterbank.</span>
0015 <span class="comment">%            3: similar to Laptev&amp;Lindberg ICPR04</span>
0016 <span class="comment">%            4: decent seperable steerable? filterbank</span>
0017 <span class="comment">%            5: berkeley filterbank for textons papers</span>
0018 <span class="comment">%            6: symmetric DOOG filters</span>
0019 <span class="comment">%          - if d==3</span>
0020 <span class="comment">%            1: decent seperable steerable filterbank</span>
0021 <span class="comment">%  show    - [0] figure to use for optional display</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% OUTPUTS</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% EXAMPLE</span>
0026 <span class="comment">%  FB = FbMake( 2, 1, 1 );</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% See also FBAPPLY2D</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% Piotr's Computer Vision Matlab Toolbox      Version 2.0</span>
0031 <span class="comment">% Copyright 2014 Piotr Dollar.  [pdollar-at-gmail.com]</span>
0032 <span class="comment">% Licensed under the Simplified BSD License [see external/bsd.txt]</span>
0033 
0034 <span class="keyword">if</span>( nargin&lt;3 || isempty(show) ); show=0; <span class="keyword">end</span>
0035 
0036 <span class="comment">% create FB</span>
0037 <span class="keyword">switch</span> dim
0038   <span class="keyword">case</span> 1
0039     FB = <a href="#_sub1" class="code" title="subfunction FB = FbMake1D( flag )">FbMake1D</a>( flag );
0040   <span class="keyword">case</span> 2
0041     FB = <a href="#_sub3" class="code" title="subfunction FB = FbMake2D( flag )">FbMake2D</a>( flag );
0042   <span class="keyword">case</span> 3
0043     FB = <a href="#_sub8" class="code" title="subfunction FB = FbMake3d( flag )">FbMake3d</a>( flag );
0044   <span class="keyword">otherwise</span>
0045     error( <span class="string">'dim must be 1 2 or 3'</span>);
0046 <span class="keyword">end</span>
0047 
0048 <span class="comment">% display</span>
0049 <a href="FbVisualize.html" class="code" title="function FbVisualize( FB, show )">FbVisualize</a>( FB, show );
0050 
0051 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0052 
0053 <a name="_sub1" href="#_subfunctions" class="code">function FB = FbMake1D( flag )</a>
0054 <span class="keyword">switch</span> flag
0055   <span class="keyword">case</span> 1  <span class="comment">%%% gabor filter bank for spatiotemporal stuff</span>
0056     omegas = 1 ./ [3 4 5 7.5 11];
0057     sigmas =      [3 4 5 7.5 11];
0058     FB = <a href="#_sub2" class="code" title="subfunction FB = FbMakegabor1D( r, sigmas, omegas )">FbMakegabor1D</a>( 15, sigmas, omegas );
0059 
0060   <span class="keyword">otherwise</span>
0061     error(<span class="string">'none created.'</span>);
0062 <span class="keyword">end</span>
0063 
0064 <a name="_sub2" href="#_subfunctions" class="code">function FB = FbMakegabor1D( r, sigmas, omegas )</a>
0065 <span class="keyword">for</span> i=1:length(omegas)
0066   [feven,fodd]=<a href="filterGabor1d.html" class="code" title="function [feven,fodd] = filterGabor1d( r, sig, omega, show )">filterGabor1d</a>(r,sigmas(i),omegas(i));
0067   <span class="keyword">if</span>( i==1 ); FB=repmat(feven,[2*length(omegas) 1]); <span class="keyword">end</span>
0068   FB(i*2-1,:)=feven; FB(i*2,:)=fodd;
0069 <span class="keyword">end</span>
0070 
0071 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0072 
0073 <a name="_sub3" href="#_subfunctions" class="code">function FB = FbMake2D( flag )</a>
0074 
0075 <span class="keyword">switch</span> flag
0076   <span class="keyword">case</span> 1  <span class="comment">%%% filter bank from Berkeley / Serge Belongie</span>
0077     r=15;
0078     FB = <a href="#_sub4" class="code" title="subfunction FB = FbMakegabor( r, nOrient, nScales, lambda, sigma )">FbMakegabor</a>( r, 6, 3, 3, sqrt(2) );
0079     FB2 = <a href="#_sub7" class="code" title="subfunction FB = FbMakeDOG( r, sigmaStr, sigmaEnd, n )">FbMakeDOG</a>( r, .6, 2.8, 4);
0080     FB = cat(3, FB, FB2);
0081     <span class="comment">%FB = FB(:,:,1:2:36); %include only even symmetric filters</span>
0082     <span class="comment">%FB = FB(:,:,2:2:36); %include only odd symmetric filters</span>
0083 
0084   <span class="keyword">case</span> 2 <span class="comment">%%% 1st/2nd order DooG filters.  Similar to Gabor filterbank.</span>
0085     FB = <a href="#_sub6" class="code" title="subfunction FB = FbMakeDooG( r, nOrient, nScales, lambda, sigma )">FbMakeDooG</a>( 15, 6, 3, 5, .5) ;
0086 
0087   <span class="keyword">case</span> 3 <span class="comment">%%% similar to Laptev&amp;Lindberg ICPR04</span>
0088     <span class="comment">% Wierd filterbank of Gaussian derivatives at various scales</span>
0089     <span class="comment">% Higher order filters probably not useful.</span>
0090     r = 9;   dims=[2*r+1 2*r+1];
0091     sigs = [.5 1 1.5 3]; <span class="comment">% sigs = [1,1.5,2];</span>
0092 
0093     derivs = [];
0094     <span class="comment">%derivs = [ derivs; 0 0 ]; % 0th order</span>
0095     <span class="comment">%derivs = [ derivs; 1 0; 0 1 ]; % first order</span>
0096     <span class="comment">%derivs = [ derivs; 2 0; 0 2; 1 1 ]; % 2nd order</span>
0097     <span class="comment">%derivs = [ derivs; 3 0; 0 3; 1 2; 2 1 ]; % 3rd order</span>
0098     <span class="comment">%derivs = [ derivs; 4 0; 0 4; 1 3; 3 1; 2 2 ]; % 4th order</span>
0099     derivs = [ derivs; 0 1; 0 2; 0 3; 0 4; 0 5]; <span class="comment">% 0n order</span>
0100     derivs = [ derivs; 1 0; 2 0; 3 0; 4 0; 5 0]; <span class="comment">% n0 order</span>
0101     cnt=1;  nderivs = size(derivs,1);
0102     <span class="keyword">for</span> s=1:length(sigs)
0103       <span class="keyword">for</span> i=1:nderivs
0104         dG = <a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, [sigs(s) sigs(s)], derivs(i,:), 0 );
0105         <span class="keyword">if</span>(s==1 &amp;&amp; i==1); FB=repmat(dG,[1 1 length(sigs)*nderivs]); <span class="keyword">end</span>
0106         FB(:,:,cnt) = dG; cnt=cnt+1;
0107         <span class="comment">%dG = filterDoog( dims, [sigs(s)*3 sigs(s)], derivs(i,:), 0 );</span>
0108         <span class="comment">%FB(:,:,cnt) = dG; cnt=cnt+1;</span>
0109         <span class="comment">%dG = filterDoog( dims, [sigs(s) sigs(s)*3], derivs(i,:), 0 );</span>
0110         <span class="comment">%FB(:,:,cnt) = dG; cnt=cnt+1;</span>
0111       <span class="keyword">end</span>
0112     <span class="keyword">end</span>
0113 
0114   <span class="keyword">case</span> 4 <span class="comment">% decent seperable steerable? filterbank</span>
0115     r = 9;   dims=[2*r+1 2*r+1];
0116     sigs = [.5 1.5 3];
0117     derivs = [1 0; 0 1; 2 0; 0 2];
0118     cnt=1;  nderivs = size(derivs,1);
0119     <span class="keyword">for</span> s=1:length(sigs)
0120       <span class="keyword">for</span> i=1:nderivs
0121         dG = <a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, [sigs(s) sigs(s)], derivs(i,:), 0 );
0122         <span class="keyword">if</span>(s==1 &amp;&amp; i==1); FB=repmat(dG,[1 1 length(sigs)*nderivs]); <span class="keyword">end</span>
0123         FB(:,:,cnt) = dG; cnt=cnt+1;
0124       <span class="keyword">end</span>
0125     <span class="keyword">end</span>
0126     FB2 = <a href="#_sub7" class="code" title="subfunction FB = FbMakeDOG( r, sigmaStr, sigmaEnd, n )">FbMakeDOG</a>( r, .6, 2.8, 4);
0127     FB = cat(3, FB, FB2);
0128 
0129   <span class="keyword">case</span> 5  <span class="comment">%%% berkeley filterbank for textons papers</span>
0130     FB = <a href="#_sub4" class="code" title="subfunction FB = FbMakegabor( r, nOrient, nScales, lambda, sigma )">FbMakegabor</a>( 7, 6, 1, 2, 2 );
0131 
0132   <span class="keyword">case</span> 6  <span class="comment">%%% symmetric DOOG filters</span>
0133     FB = <a href="#_sub5" class="code" title="subfunction FB = FbMakeDooGSym( r, nOrient, sigs )">FbMakeDooGSym</a>( 4, 2, [.5 1] );
0134 
0135   <span class="keyword">otherwise</span>
0136     error(<span class="string">'none created.'</span>);
0137 <span class="keyword">end</span>
0138 
0139 <a name="_sub4" href="#_subfunctions" class="code">function FB = FbMakegabor( r, nOrient, nScales, lambda, sigma )</a>
0140 <span class="comment">% multi-scale even/odd gabor filters. Adapted from code by Serge Belongie.</span>
0141 cnt=1;
0142 <span class="keyword">for</span> m=1:nScales
0143   <span class="keyword">for</span> n=1:nOrient
0144     [F1,F2]=<a href="filterGabor2d.html" class="code" title="function [Feven,Fodd] = filterGabor2d( r, sig, lam, theta, omega, show )">filterGabor2d</a>(r,sigma^m,lambda,180*(n-1)/nOrient);
0145     <span class="keyword">if</span>(m==1 &amp;&amp; n==1); FB=repmat(F1,[1 1 nScales*nOrient*2]); <span class="keyword">end</span>
0146     FB(:,:,cnt)=F1;  cnt=cnt+1;   FB(:,:,cnt)=F2;  cnt=cnt+1;
0147   <span class="keyword">end</span>
0148 <span class="keyword">end</span>
0149 
0150 <a name="_sub5" href="#_subfunctions" class="code">function FB = FbMakeDooGSym( r, nOrient, sigs )</a>
0151 <span class="comment">% Adds symmetric DooG filters.  These are similar to gabor filters.</span>
0152 cnt=1; dims=[2*r+1 2*r+1];
0153 <span class="keyword">for</span> s=1:length(sigs)
0154   Fodd = -<a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, [sigs(s) sigs(s)], [1 0], 0 );
0155   Feven = <a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, [sigs(s) sigs(s)], [2 0], 0 );
0156   <span class="keyword">if</span>(s==1); FB=repmat(Fodd,[1 1 length(sigs)*nOrient*2]); <span class="keyword">end</span>
0157   <span class="keyword">for</span> n=1:nOrient
0158     theta = 180*(n-1)/nOrient;
0159     FB(:,:,cnt) = imrotate( Feven, theta, <span class="string">'bil'</span>, <span class="string">'crop'</span> );  cnt=cnt+1;
0160     FB(:,:,cnt) = imrotate( Fodd,  theta, <span class="string">'bil'</span>, <span class="string">'crop'</span> );  cnt=cnt+1;
0161   <span class="keyword">end</span>
0162 <span class="keyword">end</span>
0163 
0164 <a name="_sub6" href="#_subfunctions" class="code">function FB = FbMakeDooG( r, nOrient, nScales, lambda, sigma )</a>
0165 <span class="comment">% 1st/2nd order DooG filters.  Similar to Gabor filterbank.</span>
0166 <span class="comment">% Defaults: nOrient=6, nScales=3, lambda=5, sigma=.5,</span>
0167 cnt=1; dims=[2*r+1 2*r+1];
0168 <span class="keyword">for</span> m=1:nScales
0169   sigma = sigma * m^.7;
0170   Fodd = -<a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, [sigma lambda*sigma^.6], [1,0], 0 );
0171   Feven = <a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, [sigma lambda*sigma^.6], [2,0], 0 );
0172   <span class="keyword">if</span>(m==1); FB=repmat(Fodd,[1 1 nScales*nOrient*2]); <span class="keyword">end</span>
0173   <span class="keyword">for</span> n=1:nOrient
0174     theta = 180*(n-1)/nOrient;
0175     FB(:,:,cnt) = imrotate( Feven, theta, <span class="string">'bil'</span>, <span class="string">'crop'</span> );  cnt=cnt+1;
0176     FB(:,:,cnt) = imrotate( Fodd,  theta, <span class="string">'bil'</span>, <span class="string">'crop'</span> );  cnt=cnt+1;
0177   <span class="keyword">end</span>
0178 <span class="keyword">end</span>
0179 
0180 <a name="_sub7" href="#_subfunctions" class="code">function FB = FbMakeDOG( r, sigmaStr, sigmaEnd, n )</a>
0181 <span class="comment">% adds a serires of difference of Gaussian filters.</span>
0182 sigs = sigmaStr:(sigmaEnd-sigmaStr)/(n-1):sigmaEnd;
0183 <span class="keyword">for</span> s=1:length(sigs)
0184   FB(:,:,s) = <a href="filterDog2d.html" class="code" title="function G = filterDog2d( r, var, order, show )">filterDog2d</a>(r,sigs(s),2); <span class="comment">%#ok&lt;AGROW&gt;</span>
0185   <span class="keyword">if</span>( s==1 ); FB=repmat(FB,[1 1 length(sigs)]); <span class="keyword">end</span>
0186 <span class="keyword">end</span>
0187 
0188 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0189 
0190 <a name="_sub8" href="#_subfunctions" class="code">function FB = FbMake3d( flag )</a>
0191 
0192 <span class="keyword">switch</span> flag
0193   <span class="keyword">case</span> 1 <span class="comment">% decent seperable steerable filterbank</span>
0194     r = 25; dims=[2*r+1 2*r+1 2*r+1];
0195     sigs = [.5 1.5 3];
0196     derivs = [0 0 1; 0 1 0; 1 0 0; 0 0 2; 0 2 0; 2 0 0];
0197     cnt=1; nderivs = size(derivs,1);
0198     <span class="keyword">for</span> s=1:length(sigs)
0199       <span class="keyword">for</span> i=1:nderivs
0200         dG = <a href="filterDoog.html" class="code" title="function dG = filterDoog( dims, sigmas, nderivs, show )">filterDoog</a>( dims, repmat(sigs(s),[1 3]), derivs(i,:), 0 );
0201         <span class="keyword">if</span>(s==1 &amp;&amp; i==1); FB=repmat(dG,[1 1 1 nderivs*length(sigs)]); <span class="keyword">end</span>
0202         FB(:,:,:,cnt) = dG; cnt=cnt+1;
0203       <span class="keyword">end</span>
0204     <span class="keyword">end</span>
0205 
0206   <span class="keyword">otherwise</span>
0207     error(<span class="string">'none created.'</span>);
0208 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 05-May-2022 14:52:24 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>